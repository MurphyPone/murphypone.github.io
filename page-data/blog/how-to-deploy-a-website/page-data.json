{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/how-to-deploy-a-website","result":{"data":{"markdownRemark":{"html":"<h2>Outline</h2>\n<ol>\n<li>\n<p>introduction</p>\n<ul>\n<li>purpose</li>\n<li>tools used: Google Compute Engine, Python (flask), </li>\n<li>experience required</li>\n</ul>\n</li>\n<li>Install python, flask, get GC credits, Secure a free domain, a CC (though not costs)</li>\n</ol>\n<h4>Securing a Domain</h4>\n<ul>\n<li>go to DDC and get a free .tech, .online, or .space (or cough up beans for another type)</li>\n<li>\n<p>\"Ellie the Electric Elephant\"</p>\n<ul>\n<li>explain limitations and what we're getting</li>\n<li>explain how we don't actually have to pay using the code</li>\n</ul>\n</li>\n</ul>\n<h4>Setting up our CPE</h4>\n<ul>\n<li>\n<p>create new project </p>\n<p><img src=\"/static/images/clp/gcp-1.png\"></p>\n<ul>\n<li>wait for \"Compute Engine is getting ready. This may take a minute or more.\" to resolve</li>\n</ul>\n</li>\n<li>\n<p>create new VM instance </p>\n<p><img src=\"/static/images/clp/gcp-2.png\"></p>\n</li>\n<li>configure it // explain why it can be smol and note the cost</li>\n</ul>\n<p><img src=\"/static/images/clp/gcp-3.png\">\n<img src=\"/static/images/clp/gcp-4.png\">\n<img src=\"/static/images/clp/gcp-5.png\"></p>\n<ul>\n<li>Wait for it to create</li>\n</ul>\n<p><img src=\"/static/images/clp/gcp-6.png\"></p>\n<h4>Installing dependencies</h4>\n<ul>\n<li>ssh into instance in browser</li>\n</ul>\n<p><img src=\"/static/images/clp/dep-1.png\"></p>\n<ul>\n<li>Ubuntu 20 comes with Python 3.8 installed on it, we can verify by typing <code class=\"language-text\">python3 -V</code> and see <code class=\"language-text\">Python 3.8.x</code>\n<img src=\"/static/images/clp/dep-2.png\"></li>\n<li>in order to install dependencies we need to update the <em>things</em> on our vm with <code class=\"language-text\">sudo apt update</code> - <a href=\"https://linuxize.com/post/how-to-install-pip-on-ubuntu-20.04/\">link</a></li>\n<li>\n<p>install pip with <code class=\"language-text\">sudo apt install pip3</code></p>\n<p><img src=\"/static/images/clp/dep-3.png\"></p>\n</li>\n<li>install flask for <em>explanation of Flask</em> <code class=\"language-text\">pip3 install Flask</code>, should get a success message like <code class=\"language-text\">Successfully installed Flask-1.1.2 Werkzeug-1.0.1 itsdangerous-1.1.0</code></li>\n</ul>\n<h4>Assume they have a website / show some simple code</h4>\n<ul>\n<li>clone your website code <code class=\"language-text\">$ git clone https://github.com/MurphyPone/example-flask-website</code>, <em>link to how to use github</em></li>\n</ul>\n<p>NEEDS TO BE port 0.0.0.0, and we need to reroute traffic using misha's command: </p>\n<p><code class=\"language-text\">sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 3000</code></p>\n<p>----- this stuff probably doesn't work: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">from flask import Flask, render_template\n\napp = Flask(__name__)\n\n@app.route(&#39;/&#39;)\ndef index():\n    return render_template(&#39;index.html&#39;)\n\nif __name__ == &#39;__main__&#39;:\n    app.run(debug=True)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/python3/building-app/creating-gcp-project\">https://cloud.google.com/appengine/docs/standard/python3/building-app/creating-gcp-project</a>\n<a href=\"https://cloud.google.com/sdk/docs#deb\">https://cloud.google.com/sdk/docs#deb</a></p>\n<ul>\n<li>create app.yaml from <a href=\"\">here</a></li>\n<li>do the authentication step <code class=\"language-text\">gcloud auth application-default login</code></li>\n</ul>\n<p>website will be static (define, as opposed to dynamic)</p>\n<h2>Alternatively</h2>\n<p>install the <code class=\"language-text\">gcloud</code> SDK, authenticate with <code class=\"language-text\">gcloud auth login</code> then <code class=\"language-text\">gcloud projects list</code> to view ours</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ gcloud projects list\nPROJECT_ID                 NAME                       PROJECT_NUMBER\nelectric-elephant-website  Electric Elephant Website  612669463975g</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h3>following [their docs]<a href=\"https://cloud.google.com/python/tutorials/getting-started-on-compute-engine\">https://cloud.google.com/python/tutorials/getting-started-on-compute-engine</a>) for Compute Engine -- explain the difference</h3>\n<ol>\n<li>we're working from within the gce folder</li>\n<li>cloudshell is distinct from our instance</li>\n</ol>\n<h3>EITHER WAY AFTER THAT, WE GOTTA DO CLOUD DNS</h3>\n<ol>\n<li>Network services > create a zone</li>\n<li>Add A records -- trouble here if using the <code class=\"language-text\">gcloud</code> tool since it deploys to appspot, not the ip</li>\n<li>at DDC, change nameservers to <code class=\"language-text\">ns-cloud-e1.googledomains.com</code> 1 and two</li>\n<li>VPC Networks > External IP Addresses --> change from ephemeral to static</li>\n</ol>\n<blockquote>\n<p>Manage domain name servers. You can find your domain name servers (DNS) and switch to custom name servers. Changes to DNS settings might take between several minutes and up to 48 hours to update.</p>\n</blockquote>\n<p>-- trying again Sep 1\nfrom <a href=\"https://cloud.google.com/python/tutorials/getting-started-on-compute-engine\">here</a></p>\n<ol>\n<li>Create project </li>\n<li>\n<p>Enable the Compute Engine API</p>\n<ul>\n<li>API overview > Enable > Compute Engine</li>\n</ul>\n</li>\n<li>hit Cloud shell from dashboard in the top right, wait for it to provision</li>\n<li>set the <code class=\"language-text\">gcloud</code> config with <code class=\"language-text\">gcloud config set project YOUR_PROJECT_ID</code>, which can be found in the project view menu in the hamburger dropdown in top left of dashboard</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ gcloud config set project gcp-take-5-288302\nUpdated property [core/project].</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<ol start=\"5\">\n<li>clone your repo <a href=\"https://github.com/GoogleCloudPlatform/getting-started-python/tree/master/gce\">google's</a></li>\n<li>install the requirements:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">flask==1.1.2\nhoncho==1.0.1\ngunicorn==19.9.0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>and for some reason, double install the gunicorn one? <code class=\"language-text\">pip3 install gunicorn --user</code></p>\n<ol start=\"7\">\n<li>chmod the startup script and run it </li>\n<li>follow the steps then go to cloud DNS</li>\n</ol>","frontmatter":{"date":"15 August, 2020","path":"/blog/how-to-deploy-a-website","title":"How to Deploy a Website Built with Flask to Google Cloud under a Domain.com name"},"fields":{"readingTime":{"text":"3 min read"}}}},"pageContext":{}}}